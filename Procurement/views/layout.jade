doctype html
html
  head
    title= title
    link(rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css")
    link(rel='stylesheet', href='/node_modules/bootstrap/dist/css/bootstrap.min.css')
    link(rel='stylesheet', href='/node_modules/font-awesome/css/font-awesome.min.css')
    link(rel='stylesheet', href="/node_modules/x-editable/dist/bootstrap3-editable/css/bootstrap-editable.css")
    link(rel='stylesheet', href='/stylesheets/default.css')
    link(rel='stylesheet', href='/stylesheets/style.css')
    link(rel='stylesheet', href='/node_modules/toastr/build/toastr.css')
    style.
      .fa{
        cursor: pointer;
      }
      .glyphicon-trash:before {
          content: "\e020";
          cursor: pointer;
      }
      #pagin li {
      display: inline-block;
      }
      .navbar #nav > .active > a {
      color: #fff;
      background-color: #1bbae1;
      }
      .nav-side-menu {
        overflow: auto;
        font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
        font-size: 15px;
        font-weight: 200;
        background-color: #2d334c; /* #2e353d */
        position: fixed;
        top: 0px;
        width: 25%;
        height: 100%;
        color: #e1ffff;
        margin-top: 50px;
        margin-left: -15px;
      }
      .nav-side-menu .brand {
        background-color: #23282e;
        line-height: 50px;
        display: block;
        text-align: center;
        font-size: 14px;
      }
      .nav-side-menu .toggle-btn {
        display: none;
      }
      .nav-side-menu ul,
      .nav-side-menu li {
        list-style: none;
        // padding: 0px;
        margin: 0px;
        line-height: 45px;
        cursor: pointer;
            
          .collapsed{
             .arrow:before{
                       font-family: FontAwesome;
                       content: "\f053";
                       display: inline-block;
                       padding-left:10px;
                       padding-right: 10px;
                       vertical-align: middle;
                       float:right;
                  }
           }
      
      }
      .nav-side-menu ul :not(collapsed) .arrow:before,
      .nav-side-menu li :not(collapsed) .arrow:before {
        font-family: FontAwesome;
        content: "\f078";
        display: inline-block;
        padding-left: 10px;
        padding-right: 10px;
        vertical-align: middle;
        float: right;
      }
      .nav-side-menu ul .active,
      .nav-side-menu li .active {
        border-left: 3px solid #d19b3d;
        background-color: #4f5b69;
      }
      .nav-side-menu ul .sub-menu li.active,
      .nav-side-menu li .sub-menu li.active {
        color: #d19b3d;
      }
      .nav-side-menu ul .sub-menu li.active a,
      .nav-side-menu li .sub-menu li.active a {
        color: #d19b3d;
      }
      .nav-side-menu ul .sub-menu li,
      .nav-side-menu li .sub-menu li {
        background-color: #181c20;
        border: none;
        line-height: 28px;
        border-bottom: 1px solid #23282e;
        margin-left: 0px;
      }
      .nav-side-menu ul .sub-menu li:hover,
      .nav-side-menu li .sub-menu li:hover {
        background-color: #020203;
      }
      .nav-side-menu ul .sub-menu li:before,
      .nav-side-menu li .sub-menu li:before {
        font-family: FontAwesome;
        content: "\f105";
        display: inline-block;
        padding-left: 10px;
        padding-right: 10px;
        vertical-align: middle;
      }
      .nav-side-menu li {
        // padding-left: 0px;
        border-left: 3px solid #2e353d;
        border-bottom: 1px solid #23282e;
      }
      .nav-side-menu li a {
        text-decoration: none;
        // color: #e1ffff;
      }
      .nav-side-menu li a i {
        padding-left: 10px;
        width: 20px;
        padding-right: 20px;
      }
      .nav-side-menu li:hover {
        border-left: 3px solid #d19b3d;
        background-color: #4f5b69;
        -webkit-transition: all 1s ease;
        -moz-transition: all 1s ease;
        -o-transition: all 1s ease;
        -ms-transition: all 1s ease;
        transition: all 1s ease;
      }
      @media (max-width: 767px) {
        .nav-side-menu {
          position: relative;
          width: 100%;
          margin-bottom: 10px;
        }
        .nav-side-menu .toggle-btn {
          display: block;
          cursor: pointer;
          position: absolute;
          right: 10px;
          top: 10px;
          z-index: 10 !important;
          padding: 3px;
          background-color: #ffffff;
          color: #000;
          width: 40px;
          text-align: center;
        }
        .brand {
          text-align: left !important;
          font-size: 22px;
          padding-left: 20px;
          line-height: 50px !important;
        }
      }
      @media (min-width: 767px) {
        .nav-side-menu .menu-list .menu-content {
          display: block;
        }
      }
      body {
        margin: 0px;
        padding: 0px;
      }
      .right-icon {
        padding-right: 0px;
        padding-left:0px;
        float: right;
      }
      .menu_data {
        padding-right:5px;
        padding-left:10px;
      }
      
    //- script(src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js")
    //- script(src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js")
    script(src="/node_modules/socket.io-client/dist/socket.io.js")
    script(src="/node_modules/feathers-client/dist/feathers.min.js")
    script(src="/node_modules/jquery/dist/jquery.min.js")
    script(src="/node_modules/jquery-ui-dist/jquery-ui.min.js")
    script(src="/node_modules/bootstrap/dist/js/bootstrap.min.js")
    script(src="/node_modules/moment/min/moment.min.js")
    script(src="/node_modules/x-editable/dist/bootstrap3-editable/js/bootstrap-editable.min.js")
    script(src="/node_modules/tinymce/tinymce.min.js")
    script(src="/node_modules/toastr/build/toastr.min.js")
    script(src="/js/common.js")
    script(src="/js/Schema/list.js")
    script.
      var host = (!{JSON.stringify(process.env.API_URL)}).trim() +'/'
      var dbhost = (!{JSON.stringify(process.env.INSTANCE)}).trim() +'/'
      var deleteSchema = function(self,id) {
          let url = host+'schema/' + id;
          if (confirm("Are you sure you want to delete?") == true) {
              $(self).progressbarStart();
              $.ajax({
                  url: url,
                  type: 'DELETE',
                  success: function(result) {
                      if (!result.error) {
                        //- console.log($(self));
                        $(self).closest('li').remove();
                        toastr.info('Data Deleted..','Success!!');
                        setTimeout(function() {
                          window.location.href == '/';
                        },1000);
                      }
                  },
                  complete: function () {
                      $(self).progressbarEnd();
                  }
              });
          }
      }
      $(document).ready(function(){
        $(".nav li").each(function(){
          var href = $(this).find('a').attr('href');
          if (href === window.location.pathname || (href+'/new') === window.location.pathname ) {
            $(this).addClass('active');
          }
        });
      });


  body#page-content
      nav.navbar.navbar-default
        .container-fluid
          a.pull-left(href='/')
            img(src='/images/Flowz-logo.png',style="height:45px;")
          .navbar-header
            a.navbar-brand(href='#') 
          ul.nav.navbar-nav.pull-right
            if session.userdetails.role == 'admin'
            if data
              li
                a(href='/settings')
                  i.fa.fa-cog
                  | &nbsp;Settings
            li
              a#lnkLogout(data-target='userMenu', data-toggle='dropdown',data-placement="right", role='button', aria-haspopup='true', aria-expanded='false')
                i.fa.fa-user
                | &nbsp;#{session.userdetails.fullname}&nbsp;
                span.caret
              ul#userMenu.dropdown-menu.dropdown-menu-right(aria-labelledby='lnkLogout')
                li 
                  a(href='/auth/logout') 
                    i.fa.fa-lock
                    | &nbsp;Logout
      .row(style="margin:0px;")
        .col-sm-3
          .nav-side-menu
            if data
              .menu-list
                li(style="padding-right:5px;")
                  a(href='/schema')
                    i.fa.fa-dashboard.fa-lg
                    |  Schema Definations
                    a.btn.btn-alt.btn-sm.btn-primary.pull-right.enable-tooltip(href='/schema/new', title='', data-original-title='Add new process',style="border-radius: 15px;padding-right: 8px; padding-left: 8px; min-width: 30px;text-align: center;margin-top:7px;") 
                      i.fa.fa-plus(style="padding-left:0px;padding-right:0px;width:10px")
                      | &nbsp;New
              
                if data.length == 0
                  li.text-danger.text-center
                    | No record found

                each item in data
                  li.menu_data
                    | #{item.title}
                    a.right-icon.text-danger(onclick='deleteSchema(this,"#{item._id}")', title='Delete',style="")
                        i.glyphicon.glyphicon-trash
                    a.right-icon(href='/schema/edit/#{item._id}',title='Edit',style='font-size: 15px;') 
                        i.glyphicon.glyphicon-edit
                    a.right-icon.text-warning(href="/flowInstance/#{item._id}",title="List") 
                        i.fa.fa-bars
                    a.right-icon.text-success(href="/schema/#{item._id}/new", title="Start Flow") 
                        i.fa.fa-play
                    span.arrow
                ul#service.sub-menu.collapse
                  li New Service 1
                  li New Service 2
                  li New Service 3
        .col-sm-9
            div.container(style="margin-top:20px; width: auto;")
                include partials/flash
                block content


      script.
        let schema = !{JSON.stringify(data)}